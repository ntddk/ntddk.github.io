<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>続・サンドボックスの透明性 | 一生あとで読んでろ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="耐解析機能の分類Gabriel N. BarbosaとRodrigo R. Brancoは，マルウェアの耐解析機能をAnti-Debugging, Anti-Disassembly, Obfuscation, Anti-VMの四種類に分類した．彼らはIntelのセキュリティ研究者であり，マルウェアに備わった耐解析機能の統計を過去二回に渡って発信してきた．気になるのは，サンドボックスの実装にあたって">
<meta name="keywords" content="virtual machine introspection">
<meta property="og:type" content="article">
<meta property="og:title" content="続・サンドボックスの透明性">
<meta property="og:url" content="http://ntddk.github.io/2015/03/14/sandbox-transparency-in-the-wild/index.html">
<meta property="og:site_name" content="一生あとで読んでろ">
<meta property="og:description" content="耐解析機能の分類Gabriel N. BarbosaとRodrigo R. Brancoは，マルウェアの耐解析機能をAnti-Debugging, Anti-Disassembly, Obfuscation, Anti-VMの四種類に分類した．彼らはIntelのセキュリティ研究者であり，マルウェアに備わった耐解析機能の統計を過去二回に渡って発信してきた．気になるのは，サンドボックスの実装にあたって">
<meta property="og:image" content="http://ntddk.github.io/image/anti-vm.jpg">
<meta property="og:image" content="http://ntddk.github.io/image/vm-class.png">
<meta property="og:updated_time" content="2016-07-08T08:54:08.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="続・サンドボックスの透明性">
<meta name="twitter:description" content="耐解析機能の分類Gabriel N. BarbosaとRodrigo R. Brancoは，マルウェアの耐解析機能をAnti-Debugging, Anti-Disassembly, Obfuscation, Anti-VMの四種類に分類した．彼らはIntelのセキュリティ研究者であり，マルウェアに備わった耐解析機能の統計を過去二回に渡って発信してきた．気になるのは，サンドボックスの実装にあたって">
<meta name="twitter:image" content="http://ntddk.github.io/image/anti-vm.jpg">
  
  
  <link href="//fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  
</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">一生あとで読んでろ</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">技術ブログ</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-home-icon" class="nav-icon" href="/"></a>
        
          <a id="nav-about-icon" class="nav-icon" href="/about"></a>
        
        
      </nav>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-sandbox-transparency-in-the-wild" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      続・サンドボックスの透明性
    </h1>
  

      </header>
    
    <time class="article-date" datetime="2015-03-14T12:00:00.000Z" itemprop="datePublished">03-14-2015</time>
    
  </div>
  <div class="article-inner">
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="耐解析機能の分類"><a href="#耐解析機能の分類" class="headerlink" title="耐解析機能の分類"></a>耐解析機能の分類</h1><p><a href="https://twitter.com/gabrielnb" target="_blank" rel="external">Gabriel N. Barbosa</a>と<a href="https://twitter.com/BSDaemon" target="_blank" rel="external">Rodrigo R. Branco</a>は，マルウェアの耐解析機能を<strong>Anti-Debugging, Anti-Disassembly, Obfuscation, Anti-VM</strong>の四種類に分類した．彼らはIntelのセキュリティ研究者であり，マルウェアに備わった耐解析機能の統計を過去二回に渡って発信してきた．<br>気になるのは，サンドボックスの実装にあたって問題となるAnti-VMだ．8,103,167もの検体を用いた調査によると，その内訳は以下のようになっている．</p>
<p><img src="/image/anti-vm.jpg" title="" prevalent="" characteristics="" in="" modern="" malware"より"=""></p>
<p>これらはいずれもVMware社製品を検出するための手法である．残念ながら他の仮想マシンモニタについての情報は掲載されて<strong>いない</strong>．</p>
<h1 id="仮想マシンモニタの分類"><a href="#仮想マシンモニタの分類" class="headerlink" title="仮想マシンモニタの分類"></a>仮想マシンモニタの分類</h1><p><a href="http://ntddk.github.io/2015/01/23/sandbox-transparency/">以前にも少しばかり述べた</a>，サンドボックスの透明性(transparency)に関する話を蒸し返そう．<br>サンドボックスにOut-of-the-boxなVMIを採用すれば，少なくともAnti-Debuggingについては無視できる．<br>では，サンドボックスにXenを用いれば，QEMUより検出されにくくなるだろうか．あるいは，その逆はどうだろうか．<br>多くの研究者が好き勝手なことを言っているが，仮想マシンモニタの実現手法をもってサンドボックスの透明性を語るのは些か性急だろう．なぜなら，サンドボックスの透明性はその設計ではなくマルウェアの実装によって左右されるからだ．<strong>Out-of-the-box VMIは設計の話だが，Anti-VMは実装の話だ</strong>（と思う）．<br>ところで私は，仮想マシンモニタの実現手法を「プロセッサ拡張によるもの」と「バイナリ変換によるもの」に分類していたが，別の分類方法を見つけた．</p>
<p><img src="/image/vm-class.png" title="" a="" survey="" of="" security="" issues="" in="" hardware="" virtualization"より"=""></p>
<p>命令セットアーキテクチャを基準に分類することで，より分かりやすくなっている．今後はこの図に準拠したい．<br>話を戻そう．<br>何が言いたいのかというと，in-the-wildなマルウェアに備わったAnti-VMの内訳が分からないことには，サンドボックスの透明性について云々することはできないということだ．</p>
<h1 id="検体"><a href="#検体" class="headerlink" title="検体"></a>検体</h1><p>誰もやっていないようなので，調べてみることにした．<br>やや恣意的（誤用？）な選択だが，今回は<a href="http://virusshare.com/" target="_blank" rel="external">VirusShare.com</a>からCitadelのバリアント479検体や，Mandiantの<a href="http://intelreport.mandiant.com/Mandiant_APT1_Report.pdf" target="_blank" rel="external">APT1レポート</a>にて報告された中国軍総参謀部第三部第二局こと61398部隊<strong>と思しき</strong>グループ製の874検体を含む<strong>総計33,260検体</strong>を用いた．</p>
<h1 id="Anti-VMの実態"><a href="#Anti-VMの実態" class="headerlink" title="Anti-VMの実態"></a>Anti-VMの実態</h1><p><a href="http://plusvic.github.io/yara/" target="_blank" rel="external">YARA</a>を用いてAnti-VMの実態を調べた．<br>ルールには公式の<a href="http://yararules.com/rules/antidebug.yar" target="_blank" rel="external">antidebug.yar</a>を用いた．なお，このルールにはAnti-VMのみならずAnti-Debuggerについても記載されている．</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"># awk &apos;&#123; print $1&#125;&apos; yara.log | sort | uniq -c | sort -r</div><div class="line">  20340 DebuggerPattern__RDTSC</div><div class="line">  18966 DebuggerPattern__CPUID</div><div class="line">   9292 DebuggerTiming__Ticks</div><div class="line">   7371 DebuggerPattern__SEH_Inits</div><div class="line">   6955 DebuggerException__UnhandledFilter</div><div class="line">   5715 DebuggerTiming__PerformanceCounter</div><div class="line">   4377 DebuggerPattern__SEH_Saves</div><div class="line">   2949 DebuggerCheck__API</div><div class="line">   2631 DebuggerCheck__QueryInfo</div><div class="line">   2182 SEH__vba</div><div class="line">   1315 DebuggerOutput__String</div><div class="line">    887 ThreadControl__Context</div><div class="line">    604 vmdetect</div><div class="line">    303 DebuggerException__SetConsoleCtrl</div><div class="line">    186 SEH__vectored</div><div class="line">     83 DebuggerHiding__Thread</div><div class="line">     80 DebuggerHiding__Active</div><div class="line">     52 DebuggerException__ConsoleCtrl</div><div class="line">     10 Check_Dlls</div><div class="line">      5 DebuggerCheck__RemoteAPI</div><div class="line">      2 DebuggerCheck__GlobalFlags</div><div class="line">      1 ▒▒DebuggerPattern__RDTSC</div><div class="line">      1 Debuggeattern__SEH_Inits</div><div class="line">      1 Check_VBox_VideoDrivers</div><div class="line">      1 Check_VBox_Description</div></pre></td></tr></table></figure>
<p>マルウェアの開発者がよりgenericな手法を好むことは，<code>RDTSC</code>命令を用いる検体が61.15%, <code>CPUID</code>命令を用いる検体が57.02%含まれていることからも明らかだ．たった2バイトを基準に検出しているため，false positiveだらけなのだろうとはいえ．<br>一方でvmdetectとして計上された検体は全体の1.18%に過ぎない．これはVMware, Virtual PC, Xen, Virtual Boxに関する文字列が含まれる検体を抽出するルールであり，コードは以下のようになっている．</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line">rule vmdetect</div><div class="line">&#123;</div><div class="line">    meta:</div><div class="line">        author = &quot;nex&quot;</div><div class="line">        description = &quot;Possibly employs anti-virtualization techniques&quot;</div><div class="line"></div><div class="line">    strings:</div><div class="line">        // Binary tricks</div><div class="line">        $vmware = &#123;56 4D 58 68&#125;</div><div class="line">        $virtualpc = &#123;0F 3F 07 0B&#125;</div><div class="line">        $ssexy = &#123;66 0F 70 ?? ?? 66 0F DB ?? ?? ?? ?? ?? 66 0F DB ?? ?? ?? ?? ?? 66 0F EF&#125;</div><div class="line">        $vmcheckdll = &#123;45 C7 00 01&#125;</div><div class="line">        $redpill = &#123;0F 01 0D 00 00 00 00 C3&#125;</div><div class="line"></div><div class="line">        // Random strings</div><div class="line">        $vmware1 = &quot;VMXh&quot;</div><div class="line">        $vmware2 = &quot;Ven_VMware_&quot; nocase</div><div class="line">        $vmware3 = &quot;Prod_VMware_Virtual_&quot; nocase</div><div class="line">        $vmware4 = &quot;hgfs.sys&quot; nocase</div><div class="line">        $vmware5 = &quot;mhgfs.sys&quot; nocase</div><div class="line">        $vmware6 = &quot;prleth.sys&quot; nocase</div><div class="line">        $vmware7 = &quot;prlfs.sys&quot; nocase</div><div class="line">        $vmware8 = &quot;prlmouse.sys&quot; nocase</div><div class="line">        $vmware9 = &quot;prlvideo.sys&quot; nocase</div><div class="line">        $vmware10 = &quot;prl_pv32.sys&quot; nocase</div><div class="line">        $vmware11 = &quot;vpc-s3.sys&quot; nocase</div><div class="line">        $vmware12 = &quot;vmsrvc.sys&quot; nocase</div><div class="line">        $vmware13 = &quot;vmx86.sys&quot; nocase</div><div class="line">        $vmware14 = &quot;vmnet.sys&quot; nocase</div><div class="line">        $vmware15 = &quot;vmicheartbeat&quot; nocase</div><div class="line">        $vmware16 = &quot;vmicvss&quot; nocase</div><div class="line">        $vmware17 = &quot;vmicshutdown&quot; nocase</div><div class="line">        $vmware18 = &quot;vmicexchange&quot; nocase</div><div class="line">        $vmware19 = &quot;vmdebug&quot; nocase</div><div class="line">        $vmware20 = &quot;vmmouse&quot; nocase</div><div class="line">        $vmware21 = &quot;vmtools&quot; nocase</div><div class="line">        $vmware22 = &quot;VMMEMCTL&quot; nocase</div><div class="line">        $vmware23 = &quot;vmx86&quot; nocase</div><div class="line">        $vmware24 = &quot;vmware&quot; nocase</div><div class="line">        $virtualpc1 = &quot;vpcbus&quot; nocase</div><div class="line">        $virtualpc2 = &quot;vpc-s3&quot; nocase</div><div class="line">        $virtualpc3 = &quot;vpcuhub&quot; nocase</div><div class="line">        $virtualpc4 = &quot;msvmmouf&quot; nocase</div><div class="line">        $xen1 = &quot;xenevtchn&quot; nocase</div><div class="line">        $xen2 = &quot;xennet&quot; nocase</div><div class="line">        $xen3 = &quot;xennet6&quot; nocase</div><div class="line">        $xen4 = &quot;xensvc&quot; nocase</div><div class="line">        $xen5 = &quot;xenvdb&quot; nocase</div><div class="line">        $xen6 = &quot;XenVMM&quot; nocase</div><div class="line">        $virtualbox1 = &quot;VBoxHook.dll&quot; nocase</div><div class="line">        $virtualbox2 = &quot;VBoxService&quot; nocase</div><div class="line">        $virtualbox3 = &quot;VBoxTray&quot; nocase</div><div class="line">        $virtualbox4 = &quot;VBoxMouse&quot; nocase</div><div class="line">        $virtualbox5 = &quot;VBoxGuest&quot; nocase</div><div class="line">        $virtualbox6 = &quot;VBoxSF&quot; nocase</div><div class="line">        $virtualbox7 = &quot;VBoxGuestAdditions&quot; nocase</div><div class="line">        $virtualbox8 = &quot;VBOX HARDDISK&quot;  nocase</div><div class="line"></div><div class="line">        // MAC addresses</div><div class="line">        $vmware_mac_1a = &quot;00-05-69&quot;</div><div class="line">        $vmware_mac_1b = &quot;00:05:69&quot;</div><div class="line">        $vmware_mac_1c = &quot;000569&quot;</div><div class="line">        $vmware_mac_2a = &quot;00-50-56&quot;</div><div class="line">        $vmware_mac_2b = &quot;00:50:56&quot;</div><div class="line">        $vmware_mac_2c = &quot;005056&quot;</div><div class="line">        $vmware_mac_3a = &quot;00-0C-29&quot; nocase</div><div class="line">        $vmware_mac_3b = &quot;00:0C:29&quot; nocase</div><div class="line">        $vmware_mac_3c = &quot;000C29&quot; nocase</div><div class="line">        $vmware_mac_4a = &quot;00-1C-14&quot; nocase</div><div class="line">        $vmware_mac_4b = &quot;00:1C:14&quot; nocase</div><div class="line">        $vmware_mac_4c = &quot;001C14&quot; nocase</div><div class="line">        $virtualbox_mac_1a = &quot;08-00-27&quot;</div><div class="line">        $virtualbox_mac_1b = &quot;08:00:27&quot;</div><div class="line">        $virtualbox_mac_1c = &quot;080027&quot;</div><div class="line"></div><div class="line">    condition:</div><div class="line">        any of them</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>見ての通りQEMUに関する記述が存在しない．<br>そこで，vmdetectに以下の様なコードを追加し，再度スキャンしてみた．</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">rule vmdetect</div><div class="line">&#123;</div><div class="line">    ~ 略 ~</div><div class="line"></div><div class="line">    strings:</div><div class="line">        $QEMU1 = &quot;Bochs&quot; nocase</div><div class="line">        $QEMU3 = &quot;QEMU_AUDIO_DRV&quot; nocase</div><div class="line">        $QEMU4 = &quot;QEMU VVFAT&quot; nocase</div><div class="line">        $QEMU5 = &quot;QEMU ADB Mouse&quot; nocase</div><div class="line">        $QEMU6 = &quot;QEMU ADS7846-driven Touchscreen&quot; nocase</div><div class="line">        $QEMU7 = &quot;QEMU HARDDISK&quot; nocase</div><div class="line">        $QEMU8 = &quot;QEMU CD-ROM&quot; nocase</div><div class="line">        $QEMU9 = &quot;QEMU MICRODRIVE&quot; nocase</div><div class="line">        $QEMU10 = &quot;QEMU-MEMORY&quot; nocase</div><div class="line">        $QEMU11 = &quot;QEMU_BIOS&quot; nocase</div><div class="line">        $QEMU12 = &quot;QEMU PS/2 Mouse&quot; nocase</div><div class="line">        $QEMU13 = &quot;QEMU Sun Mouse&quot; nocase</div><div class="line">        $QEMU14 = &quot;QEMU TSC2102-driven Touchscreen&quot; nocase</div><div class="line">        $QEMU15 = &quot;QEMU USB Mouse&quot; nocase</div><div class="line">        $QEMU16 = &quot;QEMU USB Tablet&quot; nocase</div><div class="line">        $QEMU17 = &quot;QEMU_VERSION&quot; nocase</div><div class="line">        $QEMU18 = &quot;QEMU USB Keyboard&quot; nocase</div><div class="line">        $QEMU19 = &quot;QEMU USB Hub&quot; nocase</div><div class="line">        $QEMU20 = &quot;QEMU USB MSD&quot; nocase</div><div class="line">        $QEMU21 = &quot;QEMU PenPartner tablet&quot; nocase</div><div class="line">        $QEMU22 = &quot;QEMUware SVGA&quot; nocase</div><div class="line"></div><div class="line">    condition:</div><div class="line">        any of them</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>結果は608検体．QEMUを検出するのは4検体だけという結果になった．<br>自分がマルウェアを開発する立場だったらこうした文字列をそのまま埋め込むことはしないし，このルールは表層的なものでしかなく，例えばQEMUの動的バイナリ変換のスケジューリングに着目したAnti-VMを検出することはできない．<br>とはいえ，おかげで現状を大雑把に把握することはできた．</p>
<h1 id="パッカーの実態"><a href="#パッカーの実態" class="headerlink" title="パッカーの実態"></a>パッカーの実態</h1><p>ついでに，<a href="http://www.softpedia.com/get/Programming/Packers-Crypters-Protectors/PEiD-updated.shtml" target="_blank" rel="external">PEiD</a>を用いてパッカーの利用状況を調べた．<br>UserDBには<a href="https://code.google.com/p/reverse-engineering-scripts/downloads/detail?name=UserDB.TXT" target="_blank" rel="external">Bob / Team PEiD signatures</a>を用いた．</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div></pre></td><td class="code"><pre><div class="line"># awk &apos;&#123;&#123;for(i=3;i&lt;NF;i++)printf(&quot;%s &quot;,$i) &#125;print($NF)&#125;&apos; peid.log | sort | uniq -c | sort -r</div><div class="line">  21159 Nothing found *</div><div class="line">   3065 Nothing found [Overlay] *</div><div class="line">   1412 Microsoft Visual Basic 5.0 / 6.0</div><div class="line">    916 Microsoft Visual C++ 8.0 DLL Method2</div><div class="line">    747 Microsoft Visual C++ 6.0</div><div class="line">    685 Microsoft Visual Basic 5.0 - 6.0</div><div class="line">    405 Borland Delphi 6.0 - 7.0 [Overlay]</div><div class="line">    351 UPX 0.89.6 - 1.02 / 1.05 - 2.90 -&gt; Markus &amp; Laszlo</div><div class="line">    333 Microsoft Visual C++ 7.0 [Overlay]</div><div class="line">    320 UPX 2.93 - 3.00 [LZMA] -&gt; Markus Oberhumer, Laszlo Molnar &amp; John Reiser [Overlay] *</div><div class="line">    239 Borland Delphi 6.0 - 7.0</div><div class="line">    201 Microsoft Visual C++ 6.0 [Overlay]</div><div class="line">    185 UPX 0.89.6 - 1.02 / 1.05 - 2.90 -&gt; Markus &amp; Laszlo [Overlay]</div><div class="line">    167 Nullsoft PiMP Stub [Nullsoft PiMP SFX] *</div><div class="line">     99 Microsoft Visual C++ 6.0 DLL</div><div class="line">     83 Microsoft Visual C++ 7.0 [Debug] [Overlay]</div><div class="line">     82 Nothing found [Debug] *</div><div class="line">     79 UPX 0.89.6 - 1.02 / 1.05 - 2.90 (Delphi) stub -&gt; Markus &amp; Laszlo [Overlay]</div><div class="line">     63 Microsoft Visual C++ 7.0</div><div class="line">     62 Microsoft Visual C# / Basic .NET</div><div class="line">     61 Microsoft Visual Basic 5.0 / 6.0 [Overlay]</div><div class="line">     42 Themida 1.8.x.x - 1.9.x.x -&gt; Oreans Technologies</div><div class="line">     42 ASPack 2.12 -&gt; Alexey Solodovnikov [Overlay]</div><div class="line">     38 ASProtect 1.2x - 1.3x [Registered] -&gt; Alexey Solodovnikov</div><div class="line">     32 ASPack 2.12 -&gt; Alexey Solodovnikov</div><div class="line">     31 PE Win32 DLL (0 EntryPoint)</div><div class="line">     31 Nothing found [RAR SFX] *</div><div class="line">     31 Microsoft Visual C++ 6.0 DLL [Overlay]</div><div class="line">     28 Borland C++</div><div class="line">     26 PECompact 2.x -&gt; Jeremy Collake [Overlay]</div><div class="line">     24 Morphine 1.2 - 1.3 -&gt; rootkit</div><div class="line">     23 MinGW GCC 3.x [Overlay] *</div><div class="line">     22 UPX 0.89.6 - 1.02 / 1.05 - 2.90 (Delphi) stub -&gt; Markus &amp; Laszlo</div><div class="line">     22 Microsoft Visual C# / Basic .NET [Overlay]</div><div class="line">     19 Nothing found [ZIP SFX] *</div><div class="line">     18 PECompact 2.x -&gt; Jeremy Collake</div><div class="line">     18 Microsoft Visual C++ 7.0 [Debug]</div><div class="line">     15 Borland C++ [Overlay]</div><div class="line">     14 Borland Delphi 4.0 - 5.0</div><div class="line">     14 ASProtect 1.33 - 2.1 Registered -&gt; Alexey Solodovnikov *</div><div class="line">     13 UPX 2.93 - 3.00 [LZMA] -&gt; Markus Oberhumer, Laszlo Molnar &amp; John Reiser *</div><div class="line">     13 Microsoft Visual C++ 6.0 [Debug]</div><div class="line">     13 Microsoft Visual C++ 5.0</div><div class="line">     12 UPX 0.80 - 1.24 DLL -&gt; Markus &amp; Laszlo</div><div class="line">     12 BobSoft Mini Delphi -&gt; BoB / BobSoft [Overlay] *</div><div class="line">     11 Themida 1.8.x.x -&gt; Oreans Technologies *</div><div class="line">     11 Microsoft Visual C++ Private Version 1</div><div class="line">     11 Borland Delphi 6.0</div><div class="line">     11 Borland Delphi 2.0 [Overlay]</div><div class="line">     10 BobSoft Mini Delphi -&gt; BoB / BobSoft *</div><div class="line">      9 NsPack 2.9 -&gt; North Star *</div><div class="line">      9 Microsoft Visual C++ 5.0 [Debug]</div><div class="line">      8 Microsoft Visual C++ 7.1 DLL</div><div class="line">      8 Microsoft Visual C++ 7.0 Method2</div><div class="line">      7 Xtreme-Protector v1.05 *</div><div class="line">      7 Microsoft Visual C++ 8.0 DLL Method2 [Overlay]</div><div class="line">      6 Xtreme-Protector v1.05 [Overlay] *</div><div class="line">      6 Microsoft Visual C++ 8.0 [Debug] [Debug]</div><div class="line">      6 ASProtect 1.2x - 1.3x [Registered] -&gt; Alexey Solodovnikov [Overlay]</div><div class="line">      5 nSPack 3.7 -&gt; North Star/Liu Xing Ping</div><div class="line">      5 Wise Installer Stub [Overlay] *</div><div class="line">      5 WinZip 32-bit SFX 8.x module</div><div class="line">      5 Thinstall 2.4x - 2.5x -&gt; Jitit Software [Overlay] *</div><div class="line">      5 PureBasic 4.x -&gt; Neil Hodgson *</div><div class="line">      5 PE Win32 DLL (0 EntryPoint) [Overlay]</div><div class="line">      5 Microsoft Visual C++ 7.1 DLL [Overlay]</div><div class="line">      4 tElock 0.98b1 -&gt; tE!</div><div class="line">      4 Themida 1.8.x.x - 1.9.x.x -&gt; Oreans Technologies [Overlay]</div><div class="line">      4 PureBasic 4.x -&gt; Neil Hodgson [Overlay] *</div><div class="line">      4 PC-Guard 5.0 -&gt; Blagoje Ceklic [Overlay]</div><div class="line">      4 MoleBox v2.0 *</div><div class="line">      4 Microsoft Visual C++ 8.0 [Debug]</div><div class="line">      4 Microsoft Visual C++ 5.0 [Overlay]</div><div class="line">      4 Borland Delphi 4.0 - 5.0 [Overlay]</div><div class="line">      4 Borland C++ 1999 [Overlay]</div><div class="line">      4 Borland C++ 1999</div><div class="line">      4 Armadillo 3.78 - 4.xx -&gt; Silicon Realms Toolworks</div><div class="line">      4 Armadillo 1.xx - 2.xx -&gt; Silicon Realms Toolworks</div><div class="line">      4 ASProtect 2.1x SKE -&gt; Alexey Solodovnikov</div><div class="line">      3 nSPack 3.7 -&gt; North Star/Liu Xing Ping [Overlay]</div><div class="line">      3 Upack 0.39 beta -&gt; Dwing</div><div class="line">      3 UPX 0.80 - 1.24 DLL -&gt; Markus &amp; Laszlo [Overlay]</div><div class="line">      3 Themida 1.2.0.1 (compressed) -&gt; Oreans Technologies [Overlay]</div><div class="line">      3 Themida 1.2.0.1 (compressed) -&gt; Oreans Technologies</div><div class="line">      3 NsPack 3.4 -&gt; North Star *</div><div class="line">      3 NakedPacker 1.0 - by BigBoote *</div><div class="line">      3 MinGW GCC 3.x [ZIP SFX] *</div><div class="line">      3 Microsoft Visual C++ [Overlay]</div><div class="line">      3 Microsoft Visual C++ 6.0 SPx Method 1</div><div class="line">      3 Microsoft Visual Basic 5.0 - 6.0 [Overlay]</div><div class="line">      3 Inno Setup Module Heuristic Mode [Overlay]</div><div class="line">      3 ASProtect 2.1x SKE -&gt; Alexey Solodovnikov [Overlay]</div><div class="line">      2 tElock 0.90 -&gt; tE! [Overlay]</div><div class="line">      2 Upack 0.28 - 0.399 (relocated image base) - Delphi, .NET, DLL -&gt; Dwing</div><div class="line">      2 Upack 0.24 - 0.29 beta -&gt; Dwing</div><div class="line">      2 UltraProtect 1.x -&gt; RISCO Software Inc. [Overlay]</div><div class="line">      2 UltraProtect 1.x -&gt; RISCO Software Inc.</div><div class="line">      2 UPX 0.89.6 - 1.02 / 1.05 - 2.90 -&gt; Markus &amp; Laszlo [RAR SFX]</div><div class="line">      2 SVKP 1.3x -&gt; Pavol Cerven</div><div class="line">      2 PureBasic DLL -&gt; Neil Hodgson *</div><div class="line">      2 PEtite 2.x [Level 0] -&gt; Ian Luck</div><div class="line">      2 PE-Armor V0.7X -&gt; hying *</div><div class="line">      2 PC-Guard 5.0 -&gt; Blagoje Ceklic</div><div class="line">      2 Nullsoft Install System 2.1x [Nullsoft PiMP SFX]</div><div class="line">      2 NsPack 1.4 -&gt; Liuxingping *</div><div class="line">      2 NTKrnl Security Suite -&gt; NTKrnl Team</div><div class="line">      2 Morphine 1.4 - 2.7 -&gt; Holy_Father &amp; Ratter/29A</div><div class="line">      2 MinGW GCC 3.x *</div><div class="line">      2 Microsoft Visual C++ Private Version 1 [Overlay]</div><div class="line">      2 Microsoft Visual C++ DLL Method 1</div><div class="line">      2 Microsoft Visual C++ 7.0 Method2 [Debug] [Overlay]</div><div class="line">      2 Microsoft Visual C++ 7.0 DLL Method 3</div><div class="line">      2 Microsoft Visual C++</div><div class="line">      2 Microsoft Visual Basic 5.0 / 6.0 [Debug]</div><div class="line">      2 MASM32 / TASM32</div><div class="line">      2 EXECryptor 2.2.4 -&gt; Strongbit/SoftComplete Development (h1) *</div><div class="line">      2 EXECryptor 1.x.x -&gt; SoftComplete Developement</div><div class="line">      2 Borland Delphi DLL</div><div class="line">      2 Borland Delphi 6.0 [Overlay]</div><div class="line">      2 Borland Delphi 3.0</div><div class="line">      2 Borland C++ DLL Method 2 [Overlay]</div><div class="line">      1 yoda&apos;s Protector 1.3 -&gt; Ashkbiz Danehkar</div><div class="line">      1 yoda&apos;s Protector 1.03.3 -&gt; Ashkbiz Danehkar</div><div class="line">      1 yoda&apos;s Protector 1.03.2 -&gt; Ashkbiz Danehkar</div><div class="line">      1 tElock v0.90 [Overlay] *</div><div class="line">      1 tElock v0.90 *</div><div class="line">      1 tElock 1.0 (private) -&gt; tE!</div><div class="line">      1 tElock 0.61 -&gt; tE!</div><div class="line">      1 nSpack V2.3 -&gt; LiuXingPing *</div><div class="line">      1 eXPressor 1.3.0 -&gt; CGSoftLabs</div><div class="line">      1 Winkript 1.0 -&gt; Mr. Crimson/WKT</div><div class="line">      1 WinRAR 32-bit SFX Module [RAR SFX] *</div><div class="line">      1 WWPack32 1.x -&gt; Piotr Warezak</div><div class="line">      1 Upack 0.28 - 0.399 (relocated image base) - Delphi, .NET, DLL -&gt; Dwing [Overlay]</div><div class="line">      1 Upack 0.24 - 0.29 beta -&gt; Dwing [Overlay]</div><div class="line">      1 UPX 1.03 - 1.04 -&gt; Markus &amp; Laszlo [Overlay]</div><div class="line">      1 UPX 1.03 - 1.04 -&gt; Markus &amp; Laszlo</div><div class="line">      1 UPX 0.89.6 - 1.02 / 1.05 - 2.90 -&gt; Markus &amp; Laszlo [Nullsoft PiMP SFX]</div><div class="line">      1 Themida 1.8.x.x -&gt; Oreans Technologies [Overlay] *</div><div class="line">      1 Themida -&gt; Oreans Technologies 2004 *</div><div class="line">      1 SafeDisc 2.05.030 -&gt; Macrovision [Overlay]</div><div class="line">      1 RLPack V1.11 -&gt; ap0x [Overlay] *</div><div class="line">      1 RLPack 1.20 Basic Edition [aPLib] -&gt; Ap0x *</div><div class="line">      1 RCryptor v1.6d --&gt; Vaska *</div><div class="line">      1 Pelles C 3.00, 4.00, 4.50 EXE (X86 CRT-LIB) [Overlay]</div><div class="line">      1 PKLITE32 v1.1 *</div><div class="line">      1 PEtite 2.x [Level 1/9] -&gt; Ian Luck [Overlay]</div><div class="line">      1 PEtite 2.x [Level 1/9] -&gt; Ian Luck</div><div class="line">      1 PEncrypt 4.0 Gamma / 4.0 Phi -&gt; junkcode</div><div class="line">      1 PESpin 0.3x - 1.xx -&gt; cyberbob</div><div class="line">      1 PECompact 2.xx --&gt; BitSum Technologies [Overlay] *</div><div class="line">      1 PECompact 2.xx --&gt; BitSum Technologies *</div><div class="line">      1 PECompact 1.40 - 1.45 -&gt; Jeremy Collake [Overlay]</div><div class="line">      1 PEBundle 2.0x - 2.4x-&gt; Jeremy Collake</div><div class="line">      1 PEBundle 0.2 - 3.x -&gt; Jeremy Collake</div><div class="line">      1 PE Pack 1.0 -&gt; ANAKiN [Overlay]</div><div class="line">      1 PE Pack 1.0 -&gt; ANAKiN</div><div class="line">      1 PE Crypt 1.02 -&gt; random, killa &amp; acpizer</div><div class="line">      1 Obsidium 1.3.0.4 -&gt; Obsidium Software [Overlay]</div><div class="line">      1 Nullsoft PiMP stub [Nullsoft PiMP SFX]</div><div class="line">      1 Nullsoft Install System 2.x [Nullsoft PiMP SFX]</div><div class="line">      1 NsPack 2.9 -&gt; North Star [Overlay] *</div><div class="line">      1 Nothing found [CAB SFX] *</div><div class="line">      1 NSPack 3.x -&gt; Liu Xing Ping *</div><div class="line">      1 Morphine 1.4 - 2.7 -&gt; Holy_Father &amp; Ratter/29A [Overlay]</div><div class="line">      1 MoleBox v2.0 [Overlay] *</div><div class="line">      1 Microsoft Visual C++ 8.0 [Debug] [Overlay]</div><div class="line">      1 Microsoft Visual C++ 7.0 Method2 [Overlay]</div><div class="line">      1 Microsoft Visual C++ 7.0 DLL Method 3 [Overlay]</div><div class="line">      1 Microsoft Visual C++ 6.0 [ZIP SFX]</div><div class="line">      1 Microsoft Visual C++ 6.0 SPx Method 1 [Overlay]</div><div class="line">      1 Microsoft Visual C++ 6.0 DLL [Debug]</div><div class="line">      1 Microsoft Visual C++ 4.x [Overlay]</div><div class="line">      1 Microsoft Visual C++ 4.x [Debug]</div><div class="line">      1 Microsoft Visual Basic 6.0 DLL [Overlay]</div><div class="line">      1 Microsoft CAB SFX module</div><div class="line">      1 LCC Win32 1.x -&gt; Jacob Navia</div><div class="line">      1 KByS V0.28 -&gt; shoooo [Overlay] *</div><div class="line">      1 KByS V0.22 -&gt; shoooo *</div><div class="line">      1 InstallShield AFW [Overlay]</div><div class="line">      1 Install Stub 32-bit -&gt; InstallShield [Overlay]</div><div class="line">      1 Inno Installer 4.0.5 [Inno SFX]</div><div class="line">      1 FSG 2.0 -&gt; bart/xt</div><div class="line">      1 EZIP 1.0 -&gt; Jonathan Clark [Overlay]</div><div class="line">      1 EXECryptor 1.x.x -&gt; SoftComplete Developement [Overlay]</div><div class="line">      1 CD-Cops II -&gt; Link Data Security [Overlay]</div><div class="line">      1 Borland Delphi DLL [Overlay]</div><div class="line">      1 Borland Delphi 5.0 KOL/MCK [Overlay]</div><div class="line">      1 Borland Delphi 5.0 KOL [Overlay]</div><div class="line">      1 Borland Delphi 3.0 [Overlay]</div><div class="line">      1 Borland Delphi 2.0 [Inno SFX]</div><div class="line">      1 Borland Delphi 2.0</div><div class="line">      1 Borland Component</div><div class="line">      1 Armadillo v1.71 [Overlay] *</div><div class="line">      1 Armadillo 3.78 - 4.xx -&gt; Silicon Realms Toolworks [Overlay]</div><div class="line">      1 Armadillo 2.01 -&gt; Silicon Realms Toolworks [Overlay]</div><div class="line">      1 ASProtect SKE 2.1x (exe) -&gt; Alexey Solodovnikov [Overlay] *</div><div class="line">      1 ASProtect 2.0x Registered -&gt; Alexey Solodovnikov [Overlay]</div><div class="line">      1 ASProtect 2.0x Registered -&gt; Alexey Solodovnikov</div><div class="line">      1 ASProtect 1.33 - 2.1 Registered -&gt; Alexey Solodovnikov [Overlay] *</div><div class="line">      1 ASProtect 1.2 / 1.2c-&gt; Alexey Solodovnikov</div><div class="line">      1 ASPack 2.12b -&gt; Alexey Solodovnikov</div><div class="line">      1 ASPack 1.08.03 -&gt; Alexey Solodovnikov [Overlay]</div><div class="line">      1 ASPack 1.06b / 1.061b -&gt; Alexey Solodovnikov [Overlay]</div><div class="line">      1 AHTeam EP Protector 0.3 (fake Microsoft Visual C++ 7.0) -&gt; FEUERRADER *</div><div class="line">      1 ACProtect V2.0 -&gt; risco *</div><div class="line">      1 ACProtect 2.00 - RISCO Software Inc. [Overlay]</div><div class="line">      1 ACProtect 1.40 - 1.41 - RISCO Software Inc.</div><div class="line">      1 .BJFNT 1.1b -&gt; :MARQUiS:</div><div class="line">      1 * PseudoSigner 0.2 [Microsoft Visual Basic 5.0 - 6.0] --&gt; Anorganix [Overlay] *</div><div class="line">      1 * PseudoSigner 0.2 [Microsoft Visual Basic 5.0 - 6.0] --&gt; Anorganix *</div></pre></td></tr></table></figure>
<p>ほとんど検出できていないのが残念．ひときわ面倒なThemidaは11検体だった．</p>
<h1 id="サンドボックスの実態"><a href="#サンドボックスの実態" class="headerlink" title="サンドボックスの実態"></a>サンドボックスの実態</h1><p>サンドボックスの透明性が研究されている一方で，実際のマルウェアはあまり凝ったAnti-VMを備えていなかった．<br>一方で，現実のサンドボックスはどうだろうか．いくら論文で優れた手法が編み出されようが，役立てられていなければ意味がない．<br>そこで，一般に公開されているサンドボックスに対してシステム情報を取得するプログラムを挿入し，仮想マシンモニタの種類を判別できるかどうか試してみたのだが，実態はあまりにもお粗末だった．<br>詳細は言うまい．<br>だが，systeminfoコマンドとNtQuerySystemInformationだけで露見する代物ばかりだった．<br>マルウェアの解析ではなく検出を目的としたサービス，言ってしまえばVirusTotalをサンドボックスのフロントエンドとしたことが，この一因として挙げられる．<br>凝ったAnti-VMを備えたマルウェアがあまり多くないことも考えると，現状のサンドボックスで十分だということなのだろうか．</p>
<h1 id="感想"><a href="#感想" class="headerlink" title="感想"></a>感想</h1><p>研究をしているうちに袋小路に突入してしまい，サンドボックスの透明性やAnti Anti-VMあくまでマルウェア解析の一側面に過ぎないことを私は忘れかけていた．<br>本質は別のところにある．</p>
<h1 id="TEQUILABOOMBOOM"><a href="#TEQUILABOOMBOOM" class="headerlink" title="TEQUILABOOMBOOM"></a>TEQUILABOOMBOOM</h1><p>公開されているサンドボックスの中にTEQUILABOOMBOOMというホスト名のものがあった．<br><a href="http://www.virusradar.com/en/Win32 Kasidet.AA/description" target="_blank" rel="external">Trojan.Win32.Inject.uljv</a>や<a href="http://securitykitten.github.io/vm-checking-and-detecting/" target="_blank" rel="external">Backdoor.Win32.Agent.dkbp</a>など一部のマルウェアは，このホスト名に基づいてサンドボックスを検出することが知られている．調べてみると，<a href="http://webcache.googleusercontent.com/search?q=cache:hackforums.net/printthread.php?tid=3733605" target="_blank" rel="external">Question about keylogged PC - Printable Version</a>や<a href="http://webcache.googleusercontent.com/search?q=cache:wrb-hdtEFFkJ:www.hackforums.net/showthread.php%3Ftid%3D4522377%26page%3D16+&amp;cd=9&amp;hl=ja&amp;ct=clnk&amp;gl=jp" target="_blank" rel="external">[FUD][FREE] Agent Tesla [Keylogger] [ClipboardLogger] [On-Screen Keyboard Logger] - Page 16</a>など，2013年の時点で情報が攻撃者の間で共有されている．</p>
<blockquote>
<p>So I managed to crypt a keylogger and have my victim download it through dropbox (I think). I haven’t received any logs yet but it shows that I’m connected to a computer from france which is janettedoe@TEQUILABOOMBOOM. I’m not sure how this is possible, or if it’s some sort of error. Does anybody know what this is? My keylogger hasn’t been sent anywhere other than to my targets email. </p>
</blockquote>
<p>どうやらこれはGoogleが動かしているCuckoo Sandboxが用いるホスト名らしく，攻撃者によるサンドボックスの実態調査が進んでいることを伺わせる．<br>サンドボックスの透明性について拘りすぎる必要はないにせよ，その情報が攻撃者の手に渡ることを前提としたサービスについては検討の余地がある．</p>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><ul>
<li>Gabriel Negreira Barbosa, Rodrigo Rubira Branco,<br>“<a href="https://www.blackhat.com/docs/us-14/materials/us-14-Branco-Prevalent-Characteristics-In-Modern-Malware.pdf" target="_blank" rel="external">Prevalent Characteristics in Modern Malware[PDF]</a>,”<br>Black Hat USA 2014.</li>
<li>Gábor Pék, Levente Buttyán, Boldizsár Bencsáth,<br>“<a href="http://www.profsandhu.com/cs6393_s14/csur_hw_virt_2013.pdf" target="_blank" rel="external">A Survey of Security Issues in Hardware Virtualization[PDF]</a>,”<br>ACM Computing Surveys, vol. 45, issue. 3, 2013.</li>
<li>“VirusShare.com,” <a href="http://virusshare.com/" target="_blank" rel="external">http://virusshare.com/</a></li>
<li><a href="http://intelreport.mandiant.com/Mandiant_APT1_Report.pdf" target="_blank" rel="external">http://intelreport.mandiant.com/Mandiant_APT1_Report.pdf[PDF]</a></li>
<li>“YARA - The pattern matching swiss knife for malware researchers,” <a href="http://plusvic.github.io/yara/" target="_blank" rel="external">http://plusvic.github.io/yara/</a></li>
<li>“PEiD Download - Softpedia,” <a href="http://www.softpedia.com/get/Programming/Packers-Crypters-Protectors/PEiD-updated.shtml" target="_blank" rel="external">http://www.softpedia.com/get/Programming/Packers-Crypters-Protectors/PEiD-updated.shtml</a></li>
<li>“Win32/Kasidet.AA | ESET Virusradar,” <a href="http://www.virusradar.com/en/Win32 Kasidet.AA/description" target="_blank" rel="external">http://www.virusradar.com/en/Win32 Kasidet.AA/description</a></li>
<li>“VM Checking and Detecting Adventures in Security,” <a href="http://securitykitten.github.io/vm-checking-and-detecting/" target="_blank" rel="external">http://securitykitten.github.io/vm-checking-and-detecting/</a></li>
<li>“Question about keylogged PC - Printable Version,” <a href="http://webcache.googleusercontent.com/search?q=cache:hackforums.net/printthread.php?tid=3733605" target="_blank" rel="external">http://webcache.googleusercontent.com/search?q=cache:hackforums.net/printthread.php?tid=3733605</a></li>
<li>“[FUD][FREE] Agent Tesla [Keylogger] [ClipboardLogger] [On-Screen Keyboard Logger] - Page 16],” <a href="http://webcache.googleusercontent.com/search?q=cache:wrb-hdtEFFkJ:www.hackforums.net/showthread.php%3Ftid%3D4522377%26page%3D16+&amp;cd=9&amp;hl=ja&amp;ct=clnk&amp;gl=jp" target="_blank" rel="external">http://webcache.googleusercontent.com/search?q=cache:wrb-hdtEFFkJ:www.hackforums.net/showthread.php%3Ftid%3D4522377%26page%3D16+&amp;cd=9&amp;hl=ja&amp;ct=clnk&amp;gl=jp</a></li>
<li>Katsunari Yoshioka, Yoshihiko Hosobuchi, Tatsunori Orii, Tsutomu Matsumoto,<br>“<a href="http://ieeexplore.ieee.org/xpl/login.jsp?tp=&amp;arnumber=5598065&amp;url=http%3A%2F%2Fieeexplore.ieee.org%2Fxpls%2Fabs_all.jsp%3Farnumber%3D5598065" target="_blank" rel="external">Vulnerability in Public Malware Sandbox Analysis Systems</a>,”<br>IEEE/IPSJ 12th International Symposium on Applications and the Internet, pp. 265-268, 2010.</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ntddk.github.io/2015/03/14/sandbox-transparency-in-the-wild/" data-id="cj9qzc73h0012eu7tucmh93dg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/virtual-machine-introspection/">virtual machine introspection</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/02/24/before-c-constructor/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          __attribute__((constructor))が呼ばれる前に
        
      </div>
    </a>
  
  
    <a href="/2015/04/03/pin-to-pemu/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">PinからPEMUへ</div>
    </a>
  
</nav>

  
</article>

</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 ntddk<br>
      <a href="https://github.com/ntddk/hexo-theme-jathena" target="_blank">JAthena</a> by <a href="https://ntddk.github.io" target="_blank">ntddk</a> | Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
  </div>

<!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
</body>
</html>